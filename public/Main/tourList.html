<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Solchan-Neoul | Tour List</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Charm&family=Oswald:wght@500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="tourList.css" />
  </head>
  <body>
    <script>
      window.onload = function () {
        // Navbar 로딩
        fetch("../Nav/navbar.html")
          .then((response) => response.text())
          .then((data) => {
            document.getElementById("navbar-container").innerHTML = data;
          });

        // tourData 로딩
        fetch("/tourList")
          .then((response) => response.json())
          .then((data) => {
            tourData = data;
            displayPage(currentPage);
            createPaginationButtons();
          });
      };
    </script>
    <div id="navbar-container"></div>
    <div id="head"></div>
    <div class="title-container">Tourist attraction</div>
    <div class="box-container" id="tourList"></div>
    <!-- start -->
    <div class="page-number">
      <ul id="pagination"></ul>
      <div id="wrap">
        <div id="footer">
          <div class="footer-container">
            <div id="margin-left"></div>
            <div id="copyright">
              <br>
              <a>Busan, Republic of Korea</a>
              <br>
              <a>ⓒ 2024 Busan-Expo2030-Association all rights reserved.</a>
              <br>
              <a>Representative: Busan-Expo2030</a>
            </div><br>
            <div id="footer-logo"></div>
          </div>
      </div>
      </div>
    </div>
    <!-- end -->
    <script>
      // Sample data from the backend
      let tourData = [];

      const itemsPerPage = 12;
      let currentPage = 1;
      const totalPages = Math.ceil(tourData.length / itemsPerPage);

      const tourListContainer = document.getElementById("tourList");
      const paginationContainer = document.getElementById("pagination");

      function displayPage(pageNumber) {
        const startIndex = (pageNumber - 1) * itemsPerPage;
        const endIndex = startIndex + itemsPerPage;
        const pageData = tourData.slice(startIndex, endIndex);

        tourListContainer.innerHTML = "";

        pageData.forEach((tour) => {
          const box = document.createElement("div");
          box.className = "box";

          // 이미지를 클릭할 때 이벤트 리스너 추가
          const imageContainer = document.createElement("div");
          imageContainer.className = "image";

          const image = document.createElement("img");
          image.src = tour.image;
          image.alt = "image";
          image.style.width = "100%";
          image.style.height = "100%";
          image.style.borderRadius = "20px";

          image.addEventListener("click", () => {
            // 클릭한 이미지에 해당하는 데이터의 인덱스를 계산
            const clickedIndex = startIndex + pageData.indexOf(tour);

            console.log(tour);
            // 상세 페이지로 이동 (예: URL 변경)
            window.location.href = `tourDetail.html?id=${tour.id}`;

            // const imageUrl = tour.image;
            // window.location.href = `tourDetail.html?title=${encodeURIComponent(tour.title)}&text=${encodeURIComponent(tour.text)}&image=${encodeURIComponent(imageUrl)}`;
          });
          const nextIcon = document.createElement("img");
          nextIcon.className = "next";
          nextIcon.src = "static/nextIcon.png";
          nextIcon.alt = "nextIcon";

          const bookmarkIcon = document.createElement("img");
          bookmarkIcon.className = "bookmark";
          bookmarkIcon.src = "static/bookmark.png";
          bookmarkIcon.alt = "bookmark";

          const title = document.createElement("div");
          title.className = "title";
          title.textContent = tour.title;

          const text = document.createElement("div");
          text.className = "text";
          text.textContent = tour.text;

          imageContainer.appendChild(image);
          imageContainer.appendChild(nextIcon);
          imageContainer.appendChild(bookmarkIcon);

          box.appendChild(imageContainer);
          box.appendChild(title);
          box.appendChild(text);

          tourListContainer.appendChild(box);
        });
      }

      function createPaginationButtons() {
        paginationContainer.innerHTML = "";

        for (let i = 1; i <= totalPages; i++) {
          const button = document.createElement("li");
          const link = document.createElement("a");
          link.href = "#";
          link.textContent = i;
          button.appendChild(link);
          paginationContainer.appendChild(button);

          // 페이지 버튼 클릭 이벤트
          link.addEventListener("click", () => {
            currentPage = i;
            displayPage(currentPage);
          });
        }
      }

      // 페이지 로드 시 첫 페이지 표시
      displayPage(currentPage);
      // 페이지 버튼 생성
      createPaginationButtons();
    </script>
  </body>
</html>
